# Subtask 0002.2: Money Scale Boundary Tests

**Parent Task**: 0002 - Domain Model Validation  
**Effort**: S (1-2h)  
**Dependencies**: None

## Description

Test Money value object at scale boundaries to ensure proper validation and handling of edge cases.

## Actions

- [x] Test scale = 0 (integer amounts)
- [x] Test scale = 50 (MAX_SCALE)
- [x] Test scale = -1 (should reject with exception)
- [x] Test scale = 51 (should reject with exception)
- [x] Add tests to existing MoneyTest class
- [x] Document scale limits in @invariant annotation

## Acceptance Criteria

- [x] Tests added for scale = 0, 50, -1, 51
- [x] Invalid scales (-1, 51) throw appropriate exceptions
- [x] Valid scales (0, 50) work correctly
- [x] Test assertions verify exact error messages
- [x] All tests pass

## Definition of Done

- [x] All boundary tests added to tests/Domain/ValueObject/MoneyTest.php
- [x] All tests pass
- [x] Edge cases documented in @invariant PHPDoc annotation on Money class
- [x] Code follows project testing patterns
- [x] Changes committed to version control

## Implementation Summary

Added 11 comprehensive scale boundary tests to `MoneyTest.php`:

**Scale 0 (Integer) Tests**:
1. `scale_zero_allows_integer_amounts()` - Verifies scale 0 works for integers
2. `scale_zero_rounds_decimals_to_integer()` - Tests HALF_UP rounding to integer

**Scale 50 (Maximum) Tests**:
3. `scale_maximum_allows_fifty_decimals()` - Confirms 50 decimal places work
4. `scale_maximum_handles_rounding_at_boundary()` - Tests rounding at scale 50

**Invalid Scale Rejection Tests**:
5. `negative_scale_throws_exception()` - Rejects scale = -1
6. `scale_above_maximum_throws_exception()` - Rejects scale = 51
7. `with_scale_rejects_negative_scale()` - Rejects negative in withScale()
8. `with_scale_rejects_scale_above_maximum()` - Rejects 51 in withScale()

**Integration Tests**:
9. `scale_boundary_with_scale_method()` - Tests withScale(0) and withScale(50)
10. `arithmetic_operations_work_at_scale_boundaries()` - Tests add/subtract at boundaries

**Test Results**: âœ… All 1,445 tests pass with 20,556 assertions

**Documentation**: Scale invariant already documented in Money class from task 0002.1:
```php
@invariant scale >= 0 && scale <= 50
```

## Tests Needed

Create test methods:
- `testScaleZeroAllowsIntegerAmounts()`
- `testScaleMaximumAllowsFiftyDecimals()`
- `testNegativeScaleThrowsException()`
- `testScaleAboveMaximumThrowsException()`

